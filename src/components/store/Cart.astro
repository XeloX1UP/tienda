---

import { listaProductos, valorAPesosChilenos, type ICartItem } from "../../assets/exports";
import CartItem from "./CartItem.astro";
const cartItems : ICartItem[] = [
    
];
const totalPrice = cartItems.reduce((total, item) => {
    const product = listaProductos.find(p => p.id === item.productId);
    if (product) {
        return total + (product.price * item.quantity);
    }
    return total;
}, 0);
---

<div class="shadow rounded-xl h-min w-[350px] p-8">
    <h2 class="bg-deep-green-600/80 h-10 flex items-center justify-center rounded-t-md">Mi pedido</h2>
    <div class=" h-full max-h-[350px] overflow-y-auto">

        {cartItems && cartItems.map(item => (
            <CartItem productId={item.productId} quantity={item.quantity} options={item.options} />
        ))}
    </div>
    <div>
        <p class="font-bold text-lg mt-4 text-end">Total: {valorAPesosChilenos(totalPrice)}</p>
        <div class="flex text-sm justify-between">
            <button class="bg-deep-green-950 text-deep-green-50 rounded-full py-2 px-2 mt-4 hover:cursor-pointer hover:scale-110 active:scale-100 transition-all hover:shadow-lg hover:shadow-deep-green-950">Finalizar compra</button>
            <button class="bg-red-500 text-white rounded-full py-2 px-4 mt-4 hover:cursor-pointer hover:scale-110 active:scale-100 transition-all hover:shadow-lg hover:shadow-deep-green-950">Vaciar carrito</button>

        </div>
    </div>
</div>